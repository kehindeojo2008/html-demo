<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Forgot Password</title>
  <link rel="stylesheet" href="./style.css" />
</head>
<body>

  <div class="container-card">
    <h1 class="title">Reset Your Password</h1>
    <p class="subtitle">
      Enter the email address associated with your account and we'll send you a password reset link.
    </p>

    <!-- Message Area -->
    <div id="resetMessage" class="message hidden"></div>

    <form id="resetForm">
      <!-- Email Input -->
      <div class="form-group">
        <label for="email" class="label">Email Address</label>
        <input type="email" id="email" name="email" required placeholder="you@example.com" class="input"/>
      </div>

      <button type="submit" id="resetPasswordBtn" class="btn">
        Send Reset Link
      </button>
    </form>
    
    <div class="login-link">
      <a href="login.html">Remembered your password? Log In</a>
    </div>
  </div>

  <script type="module" defer>
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
    import { getAuth, sendPasswordResetEmail } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyChZeZk1nL61mkukc5PvT7CCQn7HAdP5AQ",
      authDomain: "login-demo-4a733.firebaseapp.com",
      projectId: "login-demo-4a733",
      storageBucket: "login-demo-4a733.firebasestorage.app",
      messagingSenderId: "78719888700",
      appId: "1:78719888700:web:a5deb2ad505c25e8a04239"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    const messageDiv = document.getElementById('resetMessage');

    function showMessage(message, isSuccess = true) {
      messageDiv.textContent = message;
      messageDiv.classList.remove('hidden', 'error', 'success');
      messageDiv.classList.add(isSuccess ? 'success' : 'error');
      setTimeout(() => messageDiv.classList.add('hidden'), 5000);
    }

    document.getElementById('resetForm').addEventListener('submit', async (event) => {
      event.preventDefault();
      const emailInput = document.getElementById('email');
      const email = emailInput.value.trim();
      if (!email) {
        showMessage("Please enter your email address.", false);
        return;
      }

      const button = document.getElementById('resetPasswordBtn');
      const originalText = button.textContent;
      button.disabled = true;
      button.textContent = "Sending...";

      try {
        await sendPasswordResetEmail(auth, email);
        showMessage(`Password reset link sent to ${email}. Check your inbox.`, true);
        emailInput.value = '';
      } catch (error) {
        let errorMessage = "An error occurred. Please try again.";
        if (error.code === 'auth/user-not-found') errorMessage = "No user found with that email address.";
        else if (error.code === 'auth/invalid-email') errorMessage = "The email address format is invalid.";
        else if (error.code === 'auth/missing-email') errorMessage = "Email address is required.";
        showMessage(errorMessage, false);
      } finally {
        button.disabled = false;
        button.textContent = originalText;
      }
    });
  </script>
</body>
</html>
